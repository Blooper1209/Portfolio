  Source = Excel.Workbook(File.Contents("C:\Users\edral\Downloads\Uncleaned_DS_jobs.xlsx"), null, true),
    Uncleaned_DS_jobs_Sheet = Source{[Item="Uncleaned_DS_jobs",Kind="Sheet"]}[Data],
    #"Promoted Headers" = Table.PromoteHeaders(Uncleaned_DS_jobs_Sheet, [PromoteAllScalars=true]),
    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"index", Int64.Type}, {"Job Title", type text}, {"Salary Estimate", type text}, {"Job Description", type text}, {"Rating", type number}, {"Company Name", type text}, {"Location", type text}, {"Headquarters", type any}, {"Size", type any}, {"Founded", Int64.Type}, {"Type of ownership", type any}, {"Industry", type any}, {"Sector", type any}, {"Revenue", type any}, {"Competitors", type any}}),
    #"Extracted Text Before Delimiter" = Table.TransformColumns(#"Changed Type", {{"Salary Estimate", each Text.BeforeDelimiter(_, "("), type text}}),
    #"Inserted Text Between Delimiters" = Table.AddColumn(#"Extracted Text Before Delimiter", "Min Value", each Text.BetweenDelimiters([Salary Estimate], "$", "K"), type text),
    #"Inserted Text Between Delimiters1" = Table.AddColumn(#"Inserted Text Between Delimiters", "Max Value", each Text.BetweenDelimiters([Salary Estimate], "$", "K", 1, 0), type text),
    #"Renamed Columns" = Table.RenameColumns(#"Inserted Text Between Delimiters1",{{"Min Value", "Min Sal"}, {"Max Value", "Max Sal"}}),
    #"Added Custom" = Table.AddColumn(#"Renamed Columns", "Role Type", each if Text.Contains([Job Title], "Data Scientist") then
"Data Scientist"
else if Text.Contains([Job Title], "Data Analyst") then
"Data Analyst"
else if Text.Contains([Job Title], "Data Engineer") then
"Data Engineer"

else if Text.Contains([Job Title], "Machine Learning") then
"Machine Learning Engineer"
else
"other"),
    #"Changed Type1" = Table.TransformColumnTypes(#"Added Custom",{{"Role Type", type text}}),
    #"Added Custom1" = Table.AddColumn(#"Changed Type1", "Custom", each if Text.Contains([Location], ",") then [Location] else [Location] & ", Unknown"),
    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom1",{{"Custom", "Location Correction"}}),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Renamed Columns1", "Location Correction", Splitter.SplitTextByDelimiter(",", QuoteStyle.Csv), {"Location Correction.1", "Location Correction.2"}),
    #"Changed Type2" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"Location Correction.1", type text}, {"Location Correction.2", type text}}),
    #"Filtered Rows" = Table.SelectRows(#"Changed Type2", each true),
    #"Renamed Columns2" = Table.RenameColumns(#"Filtered Rows",{{"Location Correction.2", "State Abbreviations"}}),
    #"Filtered Rows1" = Table.SelectRows(#"Renamed Columns2", each ([State Abbreviations] <> " Anne Arundel")),
    #"Split Column by Delimiter1" = Table.SplitColumn(#"Filtered Rows1", "Size", Splitter.SplitTextByDelimiter(" ", QuoteStyle.Csv), {"Size.1", "Size.2"}),
    #"Changed Type3" = Table.TransformColumnTypes(#"Split Column by Delimiter1",{{"Size.1", type text}, {"Size.2", type text}}),
    #"Split Column by Delimiter2" = Table.SplitColumn(#"Changed Type3", "Size.2", Splitter.SplitTextByDelimiter(",", QuoteStyle.Csv), {"Size.2.1", "Size.2.2"}),
    #"Changed Type4" = Table.TransformColumnTypes(#"Split Column by Delimiter2",{{"Size.2.1", type text}, {"Size.2.2", type text}}),
    #"Renamed Columns3" = Table.RenameColumns(#"Changed Type4",{{"Size.2.1", "MinCompany Size"}, {"Size.1", "Size"}, {"Size.2.2", "MaxCompany Size"}}),
    #"Filtered Rows2" = Table.SelectRows(#"Renamed Columns3", each ([Competitors] = -1)),
    #"Filtered Rows3" = Table.SelectRows(#"Filtered Rows2", each ([Revenue] = "Unknown / Non-Applicable") and ([Industry] = -1)),
    #"Filtered Rows4" = Table.SelectRows(#"Filtered Rows3", each true),
    #"Removed Columns" = Table.RemoveColumns(#"Filtered Rows4",{"Job Description"})
in
    #"Removed Columns"
